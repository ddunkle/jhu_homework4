<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coding Quiz</title>

    <!-- Added link to the jQuery Library and external js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Added a link to Bootstrap and external CSS-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="./Assets/css/style.css">
</head>

<body>

    <div class="jumbotron">
        <header class="text-right" id="timer"></header>
        <h1 class="text-center">Coding Quiz Challenge</h1>
        <h4 id="msg-block" class="text-center margin-50">There are 10 questions. You have 75 seconds to complete the quiz. Each wrong
            choice will cost you 10 seconds. Click below to start the quiz.</h4>
        <div class="text-center"><button class="btn btn-primary text-center" id="btn-start">Start</button></div>
    </div>

    <div class="container">

        <div id="question-div" class="row hidden">
            <div class="col-md-12">
                <div class="card mb-2">
                    <h4 id="question-header" class="card-header">Question</h4>
                    <div class="card-body text-center">
                        <h4 id="question"></h4>
                    </div>
                </div>
            </div>
        </div>

        <div id="choices-div" class="row hidden">
            <div class="col-md-12">
                <div class="card mb-2">
                    <h4 class="card-header">Choices</h4>
                    <div class="card-body text-left">
                        <div class="row">
                            <div class="col-md-12">
                                <button id="choice-a" class="btn btn-primary btn-choice" value="a">
                                    <h1></h1>
                                </button>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <button id="choice-b" class="btn btn-primary btn-choice" value="b">
                                    <h1></h1>
                                </button>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <button id="choice-c" class="btn btn-primary btn-choice" value="c">
                                    <h1></h1>
                                </button>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <button id="choice-d" class="btn btn-primary btn-choice" value="d">
                                    <h1></h1>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="result-div" class="row hidden">
            <div class="col-md-12">
                <div class="card mb-2">
                    <h4 class="card-header">Result</h4>
                    <div class="card-body text-center">
                        <h4 id="result"></h4>
                    </div>
                </div>
            </div>
        </div>

        <div id="input-div" class="row hidden">
            <div class="col-md-12">
                <div class="card mb-2">
                    <h4 class="card-header">Enter Initials</h4>
                    <div>
                        <input type="text" id="initials">
                        <button class="btn btn-primary" id="submit-initials">Submit</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="display-div" class="row hidden">
            <div class="col-md-12">
                <div class="card mb-2">
                    <h4 class="card-header">High Scores</h4>
                    <div id="highScoreList">                       
                    </div>
                    <div>
                        <button class="btn btn-primary" id="go-back">Go Back</button>
                        <button class="btn btn-primary" id="clear-scores">Clear Scores</button>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <script type="text/javascript">
        $(document).ready(function () {

            var qCount = 0;
            var qTotal = 2; 
            var correct = 0;
            var timeLeft = 75;
            var finalTime;
            var questions = [
                {
                    title: "This is question 1",
                    choices: ["A", "B", "C", "D"],
                    answer: "a"
                }, 
                {
                    title: "This is question 2",
                    choices: ["A", "B", "C", "D"],
                    answer: "a"
                },
                {
                    title: "This is question 3",
                    choices: ["A", "B", "C", "D"],
                    answer: "a"
                },
                {
                    title: "This is question 4",
                    choices: ["A", "B", "C", "D"],
                    answer: "a"
                },
                {
                    title: "This is question 5",
                    choices: ["A", "B", "C", "D"],
                    answer: "a"
                },
                {
                    title: "This is question 6",
                    choices: ["A", "B", "C", "D"],
                    answer: "a"
                },
                {
                    title: "This is question 7",
                    choices: ["A", "B", "C", "D"],
                    answer: "a"
                },
                {
                    title: "This is question 8",
                    choices: ["A", "B", "C", "D"],
                    answer: "a"
                },
                {
                    title: "This is question 9",
                    choices: ["A", "B", "C", "D"],
                    answer: "a"
                },
                {
                    title: "This is question 10",
                    choices: ["A", "B", "C", "D"],
                    answer: "a"
                }
            ]
            var initials;

            $("#btn-start").on("click", function() {
                printQuestions(0);
                timeLeft = 75;
                $("#timer").text("Time left: " + timeLeft);
                setTime();
                $("#question-div").removeClass("hidden");
                $("#choices-div").removeClass("hidden");
                $("#result-div").removeClass("hidden");
                $("#btn-start").addClass("hidden");
            });
            $(".btn-choice").on("click", function () {
                var userChoice = $(this).val();
                if (userChoice === questions[qCount].answer) {
                    $("#result").text("Correct");
                    qCount++;
                    if (qCount < qTotal) {
                        printQuestions(qCount);
                    } else {
                        finalTime = timeLeft;
                        showResults(); 
                    }                    
                } else {
                    timeLeft = timeLeft - 10;
                    $("#result").text("Sorry, try again.");
                }
            });
            $("#submit-initials").on("click", function () {               
                if (!$("#initials").val()) {
                    alert("Please enter your initials");
                    return;
                } else {
                    initials = $("#initials").val().trim().toUpperCase();
                    printResults();                    
                }
            });
            $("#go-back").on("click", function () {
                location.reload();
            });
            $("clear-scores").on("click", function () {

            });

            function printQuestions(qNum) {
                $("#question").text(questions[qNum].title);
                $("#choice-a").text(questions[qNum].choices[0]);
                $("#choice-b").text(questions[qNum].choices[1]);
                $("#choice-c").text(questions[qNum].choices[2]);
                $("#choice-d").text(questions[qNum].choices[3]);
            }
            function setTime() {
                var timerInterval = setInterval(function() {
                    timeLeft--;
                    $("#timer").text("Time left: " + timeLeft);

                    if (timeLeft <= 0) {
                        finalTime = 0;
                        $("#timer").text("");
                        clearInterval(timerInterval);
                        showResults();
                    }

                    if (qCount >= qTotal) {
                        $("#timer").text("");
                        clearInterval(timerInterval);                        
                    }

                }, 1000);
            }
            function showResults() {
                $("#choices-div").addClass("hidden");
                $("#result-div").addClass("hidden");
                $("#question-header").text("All done!");
                $("#question").text("Your final score is: " + timeLeft);
                $("#input-div").removeClass("hidden");
            }
            function printResults() {
                $("#input-div").addClass("hidden");
                $("#question-div").addClass("hidden");
                $("#display-div").removeClass("hidden");

                var highScore = localStorage.getItem(initials);
                if (!highScore || (highScore < timeLeft)){
                    localStorage.setItem(initials, timeLeft);
                }
                
                $(#highScoreList).append()

               }

        });


    </script>

</body>

</html>